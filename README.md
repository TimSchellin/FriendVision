credit fmust be given to Robert van Straalen for part of this source code
